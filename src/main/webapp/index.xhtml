<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html">
    <h:head>
        <title>Datalogger</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <h:outputStylesheet name="css/bootstrap.css" />
        <h:outputStylesheet name="css/dataTables.bootstrap.css" />
        <h:outputStylesheet name="css/datalogger.css" />
    </h:head>
    <h:body>
        <div class="container">
            <div class="navbar navbar-default" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Datalogger</a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="./">Graph</a></li>
                        <li><a href="table.jsf">Table</a></li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="config.jsf">Config</a></li>
                    </ul>
                </div>
            </div>
            <div style="width:100%;min-height: 350px;">
                <div id="graph-container" style="height: 350px"></div>
            </div>
        </div>

        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <h:outputScript name="js/jquery.min.js" />
        <h:outputScript name="js/jquery.dataTables.min.js" />
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <h:outputScript name="js/bootstrap.min.js" />
        <h:outputScript name="js/dataTables.bootstrap.js" />
        <!--h:outputScript name="js/highstock.js" /-->
        <h:outputScript name="js/highcharts.js" />
        <!--h:outputScript library="js" name="hs/themes/gray.js" /-->

        <script type="text/javascript" charset="utf-8">
            Highcharts.setOptions({
                global: {
                    useUTC: false
                }
            });

            $(function() {
                $('#graph-container').highcharts({
                    chart: {
                        zoomType: 'xy'
                    },
                    title: {
                        text: 'Average Monthly Weather Data for Tokyo'
                    },
                    subtitle: {
                        text: 'Source: WorldClimate.com'
                    },
                    xAxis: [{
                            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                                'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                        }],
                    yAxis: [{// Primary yAxis
                            labels: {
                                formatter: function() {
                                    return this.value + '°C';
                                },
                                style: {
                                    color: '#89A54E'
                                }
                            },
                            title: {
                                text: 'Temperature',
                                style: {
                                    color: '#89A54E'
                                }
                            },
                            opposite: true

                        }, {// Secondary yAxis
                            gridLineWidth: 0,
                            title: {
                                text: 'Rainfall',
                                style: {
                                    color: '#4572A7'
                                }
                            },
                            labels: {
                                formatter: function() {
                                    return this.value + ' mm';
                                },
                                style: {
                                    color: '#4572A7'
                                }
                            }

                        }, {// Tertiary yAxis
                            gridLineWidth: 0,
                            title: {
                                text: 'Sea-Level Pressure',
                                style: {
                                    color: '#AA4643'
                                }
                            },
                            labels: {
                                formatter: function() {
                                    return this.value + ' mb';
                                },
                                style: {
                                    color: '#AA4643'
                                }
                            },
                            opposite: true
                        }],
                    tooltip: {
                        shared: true
                    },
                    legend: {
                        layout: 'vertical',
                        align: 'left',
                        x: 120,
                        verticalAlign: 'top',
                        y: 80,
                        floating: true,
                        backgroundColor: '#FFFFFF'
                    },
                    series: [{
                            name: 'Rainfall',
                            color: '#4572A7',
                            type: 'column',
                            yAxis: 1,
                            data: [49.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
                            tooltip: {
                                valueSuffix: ' mm'
                            }

                        }, {
                            name: 'Sea-Level Pressure',
                            type: 'spline',
                            color: '#AA4643',
                            yAxis: 2,
                            data: [1016, 1016, 1015.9, 1015.5, 1012.3, 1009.5, 1009.6, 1010.2, 1013.1, 1016.9, 1018.2, 1016.7],
                            marker: {
                                enabled: false
                            },
                            dashStyle: 'shortdot',
                            tooltip: {
                                valueSuffix: ' mb'
                            }

                        }, {
                            name: 'Temperature',
                            color: '#89A54E',
                            type: 'spline',
                            data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6],
                            tooltip: {
                                valueSuffix: ' °C'
                            }
                        }]
                });
            });

//            $(function() {
//                $.getJSON('resources/readings/graph', function(data) {
//                    // Add a null value for the end date 
//                    data = [].concat(data, [[Date.UTC(2011, 9, 14, 19, 59), null, null, null, null]]);
//
//                    // Create the chart
//                    $('#graph-container').highcharts('StockChart', {
//                        chart: {
//                            zoomType: 'x'
//                        },
//                        navigator: {
//                            adaptToUpdatedData: false,
//                            series: {
//                                data: data
//                            }
//                        },
//                        scrollbar: {
//                            liveRedraw: false
//                        },
//                        rangeSelector: {
//                            buttons: [{
//                                    type: 'hour',
//                                    count: 1,
//                                    text: '1h'
//                                }, {
//                                    type: 'day',
//                                    count: 1,
//                                    text: '1d'
//                                }, {
//                                    type: 'week',
//                                    count: 1,
//                                    text: '1w'
//                                }, {
//                                    type: 'month',
//                                    count: 1,
//                                    text: '1m'
//                                }, {
//                                    type: 'ytd',
//                                    text: 'YTD'
//                                }, {
//                                    type: 'year',
//                                    count: 1,
//                                    text: '1y'
//                                }, {
//                                    type: 'all',
//                                    text: 'All'
//                                }],
//                            inputEnabled: false,
//                            selected: 0
//                        },
//                        subtitle: {
//                            text: 'Current temperature .../>°C'
//                        },
//                        credits: {
//                            enabled: false
//                        },
//                        xAxis: {
//                            events: {
//                                afterSetExtremes: afterSetExtremes
//                            },
//                            minRange: 3600 * 1000 // one hour
//                        },
//                        series: [{
//                                name: 'Temperature',
//                                data: data,
//                                dataGrouping: {
//                                    enabled: false
//                                },
//                                tooltip: {
//                                    valueDecimals: 1,
//                                    valueSuffix: '°C'
//                                }
//                            }]
//                    });
//                });
//
//            });

            /**
             * Load new data depending on the selected min and max
             */
            function afterSetExtremes(e) {
                var currentExtremes = this.getExtremes(),
                        range = e.max - e.min,
                        chart = $('#graph-container').highcharts();

                chart.showLoading('Loading data from server...');
                $.getJSON('resources/readings/graph?start=' + Math.round(e.min) +
                        '&amp;end=' + Math.round(e.max), function(data) {

                    chart.series[0].setData(data);
                    chart.hideLoading();
                });
            }

//            $(document).ready(function() {
//                $('#example').dataTable({
//                });
//            });
        </script>
    </h:body>
</html>
